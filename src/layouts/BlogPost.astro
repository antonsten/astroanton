---
import Layout from './Layout.astro';
import NewsletterForm from '../components/NewsletterForm.astro';

interface Props {
    frontmatter?: {
        title: string;
        description?: string;
        date: string;
        minutesToRead?: number;
    };
    title?: string;
    description?: string;
    date?: string;
    minutesToRead?: number;
}

const { 
    title = 'Untitled Post', 
    description = '',
    date = '',
    minutesToRead = 5
} = Astro.props.frontmatter || Astro.props;

// Format the date without using browser APIs
function formatDate(dateStr: string | undefined) {
    if (!dateStr) {
        console.error('No date string provided');
        return '';
    }
    try {
        const date = new Date(dateStr);
        const months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
        return `${months[date.getMonth()]} ${date.getDate()}, ${date.getFullYear()}`;
    } catch (error) {
        console.error('Error formatting date:', error);
        return '';
    }
}

const formattedDate = formatDate(date);
---

<Layout title={title} description={description}>
    <div class="pt-32">
        <!-- Article Header -->
        <header class="mb-12">
            <h1 class="text-[32px] md:text-[50px] leading-[40px] md:leading-[56px] tracking-[-0.02em] font-medium text-black mb-4">{title}</h1>
            <div class="flex items-center gap-2 text-dark-grey text-[18px] leading-[32px] tracking-[-0.01em]">
                <time datetime={date}>{formattedDate}</time>
                <span>•</span>
                <span>{minutesToRead} minute reading time</span>
            </div>
        </header>

        <!-- Article Content -->
        <div class="prose prose-lg max-w-none">
            <slot />
        </div>

        <!-- Newsletter Section -->
        <section class="mt-16 mb-16">
            <NewsletterForm />
        </section>

        <!-- Article Footer -->
        <footer class="mt-16 pt-16 border-t border-light-grey">
            <div class="flex flex-col gap-8">
                <div class="flex items-center gap-4">
                    <a href="/articles" class="text-[16px] leading-[24px] tracking-[-0.01em] text-dark-grey hover:text-black transition-colors">← Back to articles</a>
                </div>
                <div class="flex items-center gap-4">
                    <a href="https://twitter.com/antonsten" class="text-[16px] leading-[24px] tracking-[-0.01em] text-dark-grey hover:text-black transition-colors">Share on Twitter</a>
                    <a href="https://www.linkedin.com/in/antonsten/" class="text-[16px] leading-[24px] tracking-[-0.01em] text-dark-grey hover:text-black transition-colors">Share on LinkedIn</a>
                </div>
            </div>
        </footer>
    </div>
</Layout>

<style is:global>
    /* Add any blog-specific global styles here */
    .prose {
        @apply body-lg;
    }
    
    .prose p {
        @apply mb-8;
    }

    .prose h2 {
        @apply h2 mt-24 mb-8;
    }

    .prose h3 {
        @apply h3 mt-16 mb-6;
    }

    .prose ul {
        @apply list-disc list-outside ml-6 mb-8;
    }

    .prose ol {
        @apply list-decimal list-outside ml-6 mb-8;
    }

    .prose li {
        @apply mb-2;
    }

    .prose a {
        @apply text-black underline hover:text-green transition-colors;
    }

    .prose blockquote {
        @apply relative bg-light-grey p-8 rounded-xl mb-12 !important;
    }

    .prose blockquote > div {
        @apply relative flex-1;
    }

    .prose blockquote > div > div {
        @apply relative;
    }

    .prose blockquote p {
        @apply body-xl mb-4 last:mb-0 text-black relative !important;
    }

    .prose blockquote a {
        @apply body-sm tracking-[-0.01em] font-regular opacity-80 no-underline hover:opacity-100 transition-opacity mt-4 block;
    }

    .prose code {
        @apply bg-light-grey px-2 py-1 rounded-[4px] body-lg;
    }

    .prose pre {
        @apply bg-light-grey p-6 rounded-[12px] mb-8 overflow-x-auto;
    }

    .prose pre code {
        @apply bg-transparent p-0 body-sm;
    }

    .prose img {
        @apply rounded-[12px] mb-8;
    }

    .prose figure {
        @apply mb-8;
    }

    .prose figcaption {
        @apply body-sm text-dark-grey text-center mt-4;
    }
</style> 